(window["webpackJsonp"]=window["webpackJsonp"]||[]).push([["chunk-73474dd8"],{"129f":function(e,t){e.exports=Object.is||function(e,t){return e===t?0!==e||1/e===1/t:e!=e&&t!=t}},"5d3f":function(e,t,r){"use strict";r.r(t);var n=function(){var e=this,t=e.$createElement,r=e._self._c||t;return r("div",{staticClass:"app-container"},[r("div",{staticClass:"filter-container"},[r("el-button",{staticClass:"filter-item",staticStyle:{"margin-left":"5px"},attrs:{size:"large",type:"primary",icon:"el-icon-edit"},on:{click:e.add}},[e._v("新增用户")])],1),r("el-table",{staticStyle:{width:"100%"},attrs:{id:"table",height:"68vh",border:"",data:e.userinfos.tableData}},[e._l(e.userinfos.tableAttributes,(function(e){return[r("el-table-column",{key:e.prop,staticStyle:{width:"25%"},attrs:{label:e.label,prop:e.prop,align:"center"}})]})),r("el-table-column",{staticStyle:{width:"25%"},attrs:{label:"操作",prop:"operate",fixed:"right",align:"center"},scopedSlots:e._u([{key:"default",fn:function(t){return[r("el-button",{staticClass:"c-button",attrs:{type:"primary",icon:"el-icon-edit",size:"mini"},on:{click:function(r){return e.handleEdit(t.$index,t.row)}}},[e._v("编辑 ")]),r("el-button",{staticClass:"c-button",staticStyle:{margin:"0 5px"},attrs:{type:"warning",size:"mini",icon:"el-icon-s-tools"},on:{click:function(r){return e.handleRole(t.$index,t.row)}}},[e._v("角色 ")]),r("el-popconfirm",{attrs:{"confirm-button-text":"确定","cancel-button-text":"取消",icon:"el-icon-info","icon-color":"red",title:"确定要删除该账号吗？"},on:{onConfirm:function(r){return e.handleDelete(t.$index,t.row)}}},[r("el-button",{attrs:{slot:"reference",type:"danger",size:"mini",icon:"el-icon-delete"},slot:"reference"},[e._v("删除 ")])],1)]}}])})],2),r("el-pagination",{staticStyle:{"margin-top":"2vh","text-align":"center"},attrs:{layout:"total, sizes, prev, pager, next, jumper","current-page":e.params.pageIndex,"page-sizes":[10,20,30,50,100],"page-size":e.params.pageSize,total:e.userinfos.totalCount},on:{"size-change":e.handleSizeChange,"current-change":e.handleCurrentChange}}),r("el-drawer",{attrs:{title:e.drawTitle,visible:e.drawer,direction:e.direction},on:{"update:visible":function(t){e.drawer=t}}},[r("el-form",{ref:"editForm",attrs:{model:e.form,rules:e.rules,"label-width":"80px"}},[r("el-form-item",{attrs:{label:"用户名",prop:"userName"}},[r("el-input",{staticStyle:{width:"90%"},attrs:{disabled:e.disabled},model:{value:e.form.userName,callback:function(t){e.$set(e.form,"userName",t)},expression:"form.userName"}})],1),r("el-form-item",{attrs:{label:"密码",prop:"password"}},[r("el-input",{staticStyle:{width:"90%"},attrs:{type:"password",autocomplete:"off"},model:{value:e.form.password,callback:function(t){e.$set(e.form,"password",t)},expression:"form.password"}})],1),r("el-form-item",{attrs:{label:"备注"}},[r("el-input",{staticStyle:{width:"90%"},attrs:{autocomplete:"off"},model:{value:e.form.note,callback:function(t){e.$set(e.form,"note",t)},expression:"form.note"}})],1),r("el-form-item",[r("el-button",{attrs:{type:"primary"},on:{click:function(t){return e.submitForm("editForm")}}},[e._v("保存")])],1)],1)],1),r("el-dialog",{attrs:{title:"roleDialog.title",width:"30%",visible:e.roleDialog.roleVisible,"close-on-click-modal":!1,"append-to-body":""},on:{"update:visible":function(t){return e.$set(e.roleDialog,"roleVisible",t)}}},[[[r("el-checkbox-group",{model:{value:e.checkRoles,callback:function(t){e.checkRoles=t},expression:"checkRoles"}},e._l(e.roles,(function(t){return r("el-checkbox",{key:t.value,attrs:{value:t.value,label:t.value}},[e._v(e._s(t.text))])})),1),r("span",{staticClass:"dialog-title",attrs:{slot:"title"},slot:"title"},[e._v(" "+e._s(e.roleDialog.title)+" ")]),r("span",{staticClass:"dialog-footer",attrs:{slot:"footer",title:""},slot:"footer"},[r("el-button",{on:{click:function(t){e.roleDialog.roleVisible=!1}}},[e._v("取 消")]),r("el-button",{attrs:{type:"primary"},on:{click:e.saveRoleSetting}},[e._v("确 定")])],1)]]],2)],1)},a=[],i=r("c7eb"),o=r("1da1"),s=(r("ac1f"),r("841c"),r("d3b7"),r("159b"),r("c740"),r("b775"));function l(e){return Object(s["a"])({url:"/admin",method:"get",params:e})}function c(){return Object(s["a"])({url:"/admin/roles",method:"get"})}function u(e,t){return Object(s["a"])({url:"/admin/authorization/".concat(e),method:"put",data:t})}function d(e){return Object(s["a"])({url:"/admin",method:"post",data:e})}function f(e){return Object(s["a"])({url:"/admin/authorization/".concat(e),method:"get"})}function m(e){return Object(s["a"])({url:"/admin",method:"delete",data:e})}var p={name:"Manager",data:function(){var e=this,t=function(t,r,n){""===r&&e.form.id<=0?n(new Error("请输入密码")):(""!==e.form.note&&e.$refs.editForm.validateField("note"),n())},r=function(){var e=Object(o["a"])(Object(i["a"])().mark((function e(t,r,n){return Object(i["a"])().wrap((function(e){while(1)switch(e.prev=e.next){case 0:""===r?n(new Error("请输入用户名")):n();case 1:case"end":return e.stop()}}),e)})));return function(t,r,n){return e.apply(this,arguments)}}(),n=function(e,t,r){t.length<6?r(new Error("密码不能小于6位数")):r()};return{managerId:"",disabled:!1,tree:[],params:{pageIndex:1,pageSize:10,keyWord:null},drawTitle:"新增管理员",userinfos:{tableData:[],totalCount:0,tableAttributes:[{label:"编号",prop:"id"},{label:"用户名",prop:"userName"},{label:"备注",prop:"note"},{label:"添加时间",prop:"addTime"}]},roleDialog:{title:"",userinfoId:0,roleVisible:!1},drawer:!1,rolesList:[],roleVisible:!1,direction:"rtl",form:{id:0,userName:"",password:"",note:""},projectAllList:[],rules:{userName:[{validator:r,trigger:"blur"}],password:[{validator:t,trigger:"blur"},{required:!0,trigger:"blur",validator:n}]},checkRoles:[],roles:[],isIndeterminate:!0}},watch:{},mounted:function(){this.search(),this.$nextTick((function(){var e=document.getElementsByClassName("el-pagination");e&&(document.getElementsByClassName("btn-prev")[0].innerHTML="上一页",document.getElementsByClassName("btn-next")[0].innerHTML="下一页")}))},methods:{search:function(){var e=this;l(this.params).then((function(t){t.success?(t.data.list.forEach((function(e){})),e.userinfos.totalCount=t.data.totalCount,e.userinfos.tableData=t.data.list):e.$message.error(t.msg)})).catch((function(e){console.log(e)}))},submitForm:function(e){var t=this;return Object(o["a"])(Object(i["a"])().mark((function r(){return Object(i["a"])().wrap((function(r){while(1)switch(r.prev=r.next){case 0:t.$refs[e].validate(function(){var r=Object(o["a"])(Object(i["a"])().mark((function r(n){return Object(i["a"])().wrap((function(r){while(1)switch(r.prev=r.next){case 0:if(!n){r.next=4;break}d(t.form).then((function(r){r.success?(t.$message.success("操作成功"),t.$refs[e].resetFields(),t.drawer=!1,t.search()):t.$message.error(r.msg)})),r.next=5;break;case 4:return r.abrupt("return",!1);case 5:case"end":return r.stop()}}),r)})));return function(e){return r.apply(this,arguments)}}());case 1:case"end":return r.stop()}}),r)})))()},resetForm:function(e){this.$refs[e].resetFields(),this.$refs.cascader.$refs.panel.clearCheckedNodes()},add:function(){var e=this;this.drawTitle="新增管理员",this.drawer=!0,this.$nextTick((function(){e.form.id=0,e.form.userName="",e.form.password="",e.form.note=""}))},handleEdit:function(e,t){var r=this;this.drawTitle="编辑管理员",this.drawer=!0,this.$nextTick((function(){r.form.id=t.id,r.form.userName=t.userName,r.form.note=t.note}))},handleDelete:function(e,t){var r=this;return Object(o["a"])(Object(i["a"])().mark((function e(){var n;return Object(i["a"])().wrap((function(e){while(1)switch(e.prev=e.next){case 0:return e.next=2,m([t.id]);case 2:n=e.sent,n.success?(r.$message.success("操作成功"),r.search()):r.$message.error(n.msg);case 4:case"end":return e.stop()}}),e)})))()},handleClose:function(e){e()},handleSizeChange:function(e){this.params.pageSize=e,this.search()},handleCurrentChange:function(e){this.params.pageIndex=e,this.search()},handleRole:function(e,t){var r=this;return Object(o["a"])(Object(i["a"])().mark((function e(){var n,a;return Object(i["a"])().wrap((function(e){while(1)switch(e.prev=e.next){case 0:return r.managerId=t.id,e.next=3,c();case 3:return n=e.sent,e.next=6,f(t.id);case 6:a=e.sent,n.success&&a.success?(r.roles=n.data,r.checkRoles=[],r.roles.forEach((function(e,n){a.data.findIndex((function(t){return t.roleId===e.value}))>=0&&r.$nextTick((function(){r.checkRoles.push(e.value)})),r.roleDialog.roleVisible=!0,r.roleDialog.title="设置角色【".concat(t.userName,"】")}))):r.$message.error("获取角色失败");case 8:case"end":return e.stop()}}),e)})))()},saveRoleSetting:function(){var e=this;return Object(o["a"])(Object(i["a"])().mark((function t(){return Object(i["a"])().wrap((function(t){while(1)switch(t.prev=t.next){case 0:if(!(e.checkRoles.length<=0)){t.next=3;break}return e.$message.error("最少选择一个角色"),t.abrupt("return",!1);case 3:u(e.managerId,e.checkRoles).then((function(t){e.$message.success("角色修改成功"),e.roleDialog.roleVisible=!1,e.search()}));case 4:case"end":return t.stop()}}),t)})))()}}},h=p,b=r("2877"),g=Object(b["a"])(h,n,a,!1,null,"f4812b2c",null);t["default"]=g.exports},"841c":function(e,t,r){"use strict";var n=r("d784"),a=r("825a"),i=r("1d80"),o=r("129f"),s=r("14c3");n("search",1,(function(e,t,r){return[function(t){var r=i(this),n=void 0==t?void 0:t[e];return void 0!==n?n.call(t,r):new RegExp(t)[e](String(r))},function(e){var n=r(t,e,this);if(n.done)return n.value;var i=a(e),l=String(this),c=i.lastIndex;o(c,0)||(i.lastIndex=0);var u=s(i,l);return o(i.lastIndex,c)||(i.lastIndex=c),null===u?-1:u.index}]}))}}]);