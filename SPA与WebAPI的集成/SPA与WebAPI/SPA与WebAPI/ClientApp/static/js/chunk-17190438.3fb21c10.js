(window["webpackJsonp"]=window["webpackJsonp"]||[]).push([["chunk-17190438"],{"2e25":function(t,e,s){},4109:function(t,e,s){"use strict";s("aaaf")},"5efa":function(t,e,s){"use strict";s.d(e,"d",(function(){return n})),s.d(e,"a",(function(){return r})),s.d(e,"b",(function(){return i})),s.d(e,"c",(function(){return o}));var a=s("b775");function n(t){return Object(a["a"])({url:"/season",method:"get",params:t})}function r(t){return Object(a["a"])({url:"/season",method:"post",data:t})}function i(t){return Object(a["a"])({url:"/season/".concat(t),method:"DELETE"})}function o(t){return Object(a["a"])({url:"/season/IsEnableAsync?id=".concat(t),method:"POST"})}},"64b2":function(t,e,s){"use strict";s.r(e);var a=function(){var t=this,e=t.$createElement,s=t._self._c||e;return s("div",{staticClass:"app-container advice-container"},[s("div",{staticClass:"bread"},[s("div",{staticStyle:{color:"#4876e6"},on:{click:t.handleCancle}},[t._v("代表建议列表")]),s("div",{directives:[{name:"show",rawName:"v-show",value:t.show,expression:"show"}],staticStyle:{color:"#5b8cff",margin:"0 15px"}},[t._v("/")]),s("div",{directives:[{name:"show",rawName:"v-show",value:t.show,expression:"show"}],staticStyle:{color:"#b5c8f2"}},[t._v(" "+t._s(t.form.id?"建议详情":"新增建议")+" ")])]),s("div",{directives:[{name:"show",rawName:"v-show",value:!t.show,expression:"!show"}],staticClass:"main"},[s("div",{staticClass:"filterbar"},[s("div",{staticClass:"dropdown"},[s("el-dropdown",{on:{command:t.handleCommand}},[s("el-button",{attrs:{type:"primary"}},[t._v(" "+t._s(t.commandTag)),s("i",{staticClass:"el-icon-arrow-down el-icon--right"})]),s("el-dropdown-menu",{attrs:{slot:"dropdown"},slot:"dropdown"},t._l(t.options,(function(e){return s("el-dropdown-item",{key:e.value,staticStyle:{width:"100%"},attrs:{command:e.lable}},[t._v(t._s(e.lable))])})),1)],1)],1),s("div",{staticClass:"tags"},[s("div",{staticClass:"tip"},[t._v("状态：")]),s("div",{class:t.checkPermission(["Liaison","rd"])?10===t.params.status.length?"current":"tag":9===t.params.status.length?"current":"tag",on:{click:function(e){t.check(t.checkPermission(["Liaison","rd"])?{value:[0,1,2,3,4,5,6,7,8,9]}:{value:[1,2,3,4,5,6,7,8,9]})}}},[t._v(" 全部 ")]),t._l(t.tags,(function(e){return s("div",{directives:[{name:"show",rawName:"v-show",value:0!==e.value[0]||t.checkPermission(["Liaison","rd"]),expression:"item.value[0] !== 0 || checkPermission(['Liaison','rd'])"}],key:e.label,class:t.params.status===e.value?"current":"tag",on:{click:function(s){return t.check(e)}}},[t._v(" "+t._s(e.label)+" ")])})),s("div",{staticStyle:{margin:"0 5px"}},[t._v("|")]),s("div",{class:t.checkPermission(["Liaison","rd"])?9===t.params.status.length?"current":"tag":8===t.params.status.length?"current":"tag",on:{click:function(e){t.check(t.checkPermission(["Liaison","rd"])?{value:[0,1,2,3,4,5,6,7,8]}:{value:[1,2,3,4,5,6,7,8]})}}},[t._v(" 所有未办结 ")])],2),s("div",{staticClass:"search"},[s("el-input",{staticClass:"searchInput",staticStyle:{width:"200px","border-radius":"50px"},attrs:{placeholder:"请输入关键词搜索"},nativeOn:{keyup:function(e){return!e.type.indexOf("key")&&t._k(e.keyCode,"enter",13,e.key,"Enter")?null:t.getList(e)}},model:{value:t.params.kw,callback:function(e){t.$set(t.params,"kw",e)},expression:"params.kw"}}),s("i",{staticClass:"el-icon-search",on:{click:t.getList}})],1),t.checkPermission(["Liaison","rd"])?s("el-button",{staticClass:"addBtn",attrs:{type:"primary"},on:{click:function(e){t.show=!0,t.firstCascaderValue=[],t.secondCascaderValue=[]}}},[t._v("新增建议")]):t._e()],1),s("div",{staticClass:"table"},[s("el-table",{attrs:{data:t.suggestList,index:t.indexMethod,stripe:"",border:"",height:"630"}},[s("el-table-column",{attrs:{width:"60",type:"index",label:"序号",align:"center",index:t.indexMethod}}),s("el-table-column",{attrs:{width:"80",prop:"id",label:"建议编号",align:"center"},scopedSlots:t._u([{key:"default",fn:function(e){var s=e.row;return[t._v(" "+t._s(s.code)+" ")]}}])}),s("el-table-column",{attrs:{width:"80",prop:"proponent",label:"建议人",align:"center"},scopedSlots:t._u([{key:"default",fn:function(e){var s=e.row;return[t._v(" "+t._s(s.proposer)+" ")]}}])}),s("el-table-column",{attrs:{prop:"title",label:"【届次】标题",align:"left"},scopedSlots:t._u([{key:"default",fn:function(e){var a=e.row;return[s("div",{staticClass:"title"},[s("span",{staticClass:"session"},[t._v(" "+t._s(a.tag)+" ")]),s("span",{staticClass:"text"},[t._v(" "+t._s(a.title)+" ")])])]}}])}),s("el-table-column",{attrs:{prop:"situation",label:"答复状况",align:"center"},scopedSlots:t._u([{key:"default",fn:function(e){var a=e.row;return[s("div",[t._v(" 一次答复："+t._s(null!==a.grade?"已答复":"未答复")+" ")]),s("div",{directives:[{name:"show",rawName:"v-show",value:null!==a.secondGrade,expression:"row.secondGrade !== null"}]},[t._v("二次答复：已答复")])]}}])}),s("el-table-column",{attrs:{width:"160",prop:"satisfaction",label:"满意度",align:"center"},scopedSlots:t._u([{key:"default",fn:function(e){var a=e.row;return[s("div",[t._v(" 一次反馈："+t._s(1===a.grade?"满意":2===a.grade?"基本满意":3===a.grade?"不满意":"未答复")+" ")]),s("div",{directives:[{name:"show",rawName:"v-show",value:null!==a.secondGrade,expression:"row.secondGrade !== null"}]},[t._v(" 二次反馈："+t._s(1===a.secondGrade?"满意":2===a.secondGrade?"基本满意":3===a.secondGrade?"不满意":"未答复")+" ")])]}}])}),s("el-table-column",{attrs:{width:"200",prop:"time",label:"提交时间",align:"center"},scopedSlots:t._u([{key:"default",fn:function(e){var s=e.row;return[t._v(" "+t._s(s.addTime)+" ")]}}])}),s("el-table-column",{attrs:{width:"120",prop:"status",label:"状态",align:"center"},scopedSlots:t._u([{key:"default",fn:function(e){var a=e.row;return[s("span",{staticStyle:{color:"#c52514"}},[t._v(t._s(1===a.status?"待审核":2===a.status?"待分配":3===a.status?"待签收":4===a.status?"第一次处理中":5===a.status?"第一次已答复":6===a.status?"第二次处理中":7===a.status?"第二次已答复":9===a.status?"已办结":0===a.status?"未提交":8===a.status?"待办结处理":""))])]}}])}),s("el-table-column",{attrs:{width:"180",label:"操作",align:"center"},scopedSlots:t._u([{key:"default",fn:function(e){var a=e.row;return[t.checkPermission(["admin"])?s("el-button",{attrs:{type:"primary"},on:{click:function(e){return t.checkDetail(a)}}},[t._v("查看")]):t._e(),t.checkPermission(["Liaison","rd"])?s("el-button",{attrs:{type:"primary"},on:{click:function(e){return t.checkDetail(a)}}},[t._v(t._s(0===a.status?"编辑":"查看"))]):t._e(),t.checkPermission(["Committee","Allocation"])?s("el-button",{attrs:{type:"primary"},on:{click:function(e){return t.checkDetail(a)}}},[t._v(" "+t._s(1===a.status?"审核":2===a.status?"分配":"查看")+" ")]):t._e(),t.checkPermission(["Process"])?s("el-button",{attrs:{type:"primary"},on:{click:function(e){return t.checkDetail(a)}}},[t._v(t._s(4===a.status?"处理":"查看"))]):t._e(),t.hasExportRight&&2===a.status?s("el-button",{on:{click:function(e){return t.btnDownload(a)}}},[t._v("下载")]):t._e()]}}])})],1),s("el-pagination",{staticStyle:{"margin-top":"2vh","margin-bottom":"1vh","text-align":"center"},attrs:{layout:"total, sizes, prev, pager, next, jumper","current-page":t.params.pageIndex,"page-sizes":[10,20,30,50,100],"page-size":t.params.pageSize,total:t.suggestList.totalCount},on:{"size-change":t.handleSizeChange,"current-change":t.handleCurrentChange}})],1)]),s("el-dialog",{attrs:{visible:t.recordVisible,title:"申请记录",width:"80%","custom-class":"record"},on:{"update:visible":function(e){t.recordVisible=e}}},[s("el-table",{attrs:{data:t.suggestList,stripe:"",border:""}},[s("el-table-column",{attrs:{width:"200",prop:"status",label:"状态",align:"center"},scopedSlots:t._u([{key:"default",fn:function(e){var a=e.row;return[s("span",{staticStyle:{color:"#c52514"}},[t._v(t._s(1===a.status?"待审核":2===a.status?"待分配":3===a.status?"待签收":4===a.status?"第一次处理中":5===a.status?"第一次已答复":6===a.status?"第二次处理中":7===a.status?"第二次已答复":9===a.status?"已办结":0===a.status?"未提交":""))])]}}])}),s("el-table-column",{attrs:{prop:"id",label:"内容",align:"center"},scopedSlots:t._u([{key:"default",fn:function(e){var s=e.row;return[t._v(" "+t._s(s.code)+" ")]}}])}),s("el-table-column",{attrs:{width:"200",prop:"title",label:"结果",align:"center"},scopedSlots:t._u([{key:"default",fn:function(e){var a=e.row;return[s("div",{staticClass:"title"},[s("span",{staticClass:"session"},[t._v(" "+t._s(a.tag)+" ")]),s("span",{staticClass:"text"},[t._v(" "+t._s(a.title)+" ")])])]}}])}),s("el-table-column",{attrs:{width:"200",prop:"time",label:"申请时间",align:"center"},scopedSlots:t._u([{key:"default",fn:function(e){var s=e.row;return[t._v(" "+t._s(s.addTime)+" ")]}}])})],1)],1),s("div",{directives:[{name:"show",rawName:"v-show",value:t.show,expression:"show"}],staticClass:"edit"},[t.form.status<2?s("div",{staticClass:"form"},[s("el-form",{ref:"form",staticStyle:{height:"100%",position:"relative","padding-bottom":"100px"},attrs:{rules:t.rules,model:t.form,"label-width":"100px"}},[(t.form.code||"").length>0?s("el-form-item",{staticClass:"formItem",attrs:{prop:"",label:"建议编号:"}},[s("el-input",{staticStyle:{width:"30%"},attrs:{disabled:""},model:{value:t.form.code,callback:function(e){t.$set(t.form,"code",e)},expression:"form.code"}})],1):t._e(),s("el-form-item",{staticClass:"formItem",attrs:{prop:"metting",label:"会议期间:"}},[s("el-select",{staticStyle:{width:"30%"},attrs:{disabled:!t.canEditForm,"placeho-alder":"请选择会议期间"},model:{value:t.form.metting,callback:function(e){t.$set(t.form,"metting",e)},expression:"form.metting"}},[s("el-option",{attrs:{label:"开会期间",value:"A"}}),s("el-option",{attrs:{label:"闭会期间",value:"B"}})],1)],1),s("el-form-item",{staticClass:"formItem",attrs:{prop:"category",label:"建议类型:"}},[s("el-select",{staticStyle:{width:"30%"},attrs:{disabled:!t.canEditForm,filterable:"","placeho-alder":"请选择建议类型"},model:{value:t.form.category,callback:function(e){t.$set(t.form,"category",e)},expression:"form.category"}},[s("el-option",{attrs:{label:"党群类",value:"党群类"}}),s("el-option",{attrs:{label:"财政经济类",value:"财政经济类"}}),s("el-option",{attrs:{label:"社会建设类",value:"社会建设类"}}),s("el-option",{attrs:{label:"监察司法类",value:"监察司法类"}}),s("el-option",{attrs:{label:"城建环保类",value:"城建环保类"}}),s("el-option",{attrs:{label:"农业农村类",value:"农业农村类"}}),s("el-option",{attrs:{label:"教科文卫类",value:"教科文卫类"}}),s("el-option",{attrs:{label:"民族宗教类",value:"民族宗教类"}}),s("el-option",{attrs:{label:"综合管理类",value:"综合管理类"}}),s("el-option",{attrs:{label:"其他类",value:"其他类"}})],1)],1),s("el-form-item",{staticClass:"formItem",attrs:{prop:"title",label:"建议标题:"}},[s("el-input",{staticStyle:{width:"50%"},attrs:{disabled:!t.canEditForm},model:{value:t.form.title,callback:function(e){t.$set(t.form,"title",e)},expression:"form.title"}})],1),s("el-form-item",{staticClass:"formItem",attrs:{prop:"first",label:"主提议人:"}},[s("el-cascader",{staticStyle:{width:"30%"},attrs:{options:t.cascaderStaffList,disabled:!t.canEditForm,placeholder:"请选择主提议人"},model:{value:t.firstCascaderValue,callback:function(e){t.firstCascaderValue=e},expression:"firstCascaderValue"}})],1),s("el-form-item",{staticClass:"formItem",attrs:{prop:"seconds",label:"附议人:"}},[s("el-cascader",{staticStyle:{width:"100%"},attrs:{props:{multiple:!0},options:t.secondsCascader,disabled:!t.canEditForm,placeholder:"请选择附议人"},model:{value:t.secondCascaderValue,callback:function(e){t.secondCascaderValue=e},expression:"secondCascaderValue"}})],1),s("el-form-item",{staticClass:"formItem",attrs:{prop:"time",label:"建议时间:"}},[s("el-date-picker",{staticStyle:{width:"50%"},attrs:{disabled:!t.canEditForm,"value-format":"yyyy-MM-dd HH:mm:ss","picker-options":t.expireTimeOption,type:"datetime",placeholder:"选择时间"},model:{value:t.form.time,callback:function(e){t.$set(t.form,"time",e)},expression:"form.time"}})],1),s("el-form-item",{attrs:{label:"建议内容:",prop:"content"}},[s("el-input",{staticStyle:{width:"80%"},attrs:{disabled:!t.canEditForm,type:"textarea",autosize:{minRows:7,maxRows:15},resize:"none"},model:{value:t.form.content,callback:function(e){t.$set(t.form,"content",e)},expression:"form.content"}})],1),0===t.form.status?s("el-form-item",{staticClass:"operating"},[s("el-button",{on:{click:t.handleCancle}},[t._v("取消")]),s("el-button",{attrs:{type:"primary"},on:{click:t.save}},[t._v("仅保存")]),s("el-button",{attrs:{type:"primary"},on:{click:t.submit}},[t._v("保存并提交")])],1):t._e(),t.checkPermission(["Committee"])&&1===t.form.status?s("el-form-item",{staticStyle:{"text-align":"right"}},[s("el-button",{on:{click:function(e){return t.showDialog(1)}}},[t._v("不通过")]),s("el-button",{attrs:{type:"primary"},on:{click:t.handleAudit}},[t._v("通过")]),s("el-button",{attrs:{type:"danger"},on:{click:t.committeeUpdateSuggest}},[t._v(t._s(t.committeeEditStatus?"保存":"修改"))])],1):t._e()],1)],1):t._e(),t.checkPermission(["Liaison","rd"])&&0===t.form.status&&2===t.form.checkStatus?s("div",{staticClass:"reasonBox"},[s("el-form",{attrs:{"label-width":"100px"}},[s("el-form-item",{attrs:{label:"未通过原因:"}},[s("el-input",{attrs:{type:"textarea",rows:"4",resize:"none",disabled:""},model:{value:t.form.reason,callback:function(e){t.$set(t.form,"reason",e)},expression:"form.reason"}})],1)],1)],1):t._e(),s("div",{directives:[{name:"show",rawName:"v-show",value:t.form.status>=2,expression:"form.status >= 2"}],staticClass:"executive"},[s("div",{staticClass:"detail"},[s("el-form",{staticStyle:{height:"100%",position:"relative","padding-bottom":"20px"},attrs:{model:t.form,"label-width":"100px"}},[s("el-form-item",{staticClass:"formItem",attrs:{label:"建议编号:"}},[s("el-input",{attrs:{disabled:""},model:{value:t.form.code,callback:function(e){t.$set(t.form,"code",e)},expression:"form.code"}})],1),s("el-form-item",{staticClass:"formItem",attrs:{label:"会议期间:"}},[s("el-select",{staticStyle:{width:"100%"},attrs:{"placeho-alder":"请选择会议期间",disabled:""},model:{value:t.form.metting,callback:function(e){t.$set(t.form,"metting",e)},expression:"form.metting"}},[s("el-option",{attrs:{label:"开会期间",value:"A"}}),s("el-option",{attrs:{label:"闭会期间",value:"B"}})],1)],1),s("el-form-item",{staticClass:"formItem",attrs:{label:"建议类型:"}},[s("el-input",{attrs:{disabled:""},model:{value:t.form.category,callback:function(e){t.$set(t.form,"category",e)},expression:"form.category"}})],1),s("el-form-item",{staticClass:"formItem",attrs:{label:"建议标题:"}},[s("el-input",{attrs:{disabled:""},model:{value:t.form.title,callback:function(e){t.$set(t.form,"title",e)},expression:"form.title"}})],1),s("el-form-item",{staticClass:"formItem",attrs:{label:"主提议人:"}},[s("el-cascader",{staticStyle:{width:"100%"},attrs:{options:t.cascaderStaffList,disabled:"",placeholder:"请选择主提议人"},model:{value:t.firstCascaderValue,callback:function(e){t.firstCascaderValue=e},expression:"firstCascaderValue"}})],1),s("el-form-item",{staticClass:"formItem",attrs:{label:"附议人:"}},[s("el-cascader",{staticStyle:{width:"100%"},attrs:{props:{multiple:!0},options:t.secondsCascader,disabled:!t.canEditForm,placeholder:"请选择附议人"},model:{value:t.secondCascaderValue,callback:function(e){t.secondCascaderValue=e},expression:"secondCascaderValue"}})],1),s("el-form-item",{staticClass:"formItem",attrs:{label:"建议时间:"}},[s("el-input",{attrs:{disabled:""},model:{value:t.form.time,callback:function(e){t.$set(t.form,"time",e)},expression:"form.time"}})],1),s("el-form-item",{attrs:{label:"建议内容:"}},[s("el-input",{attrs:{type:"textarea",rows:"7",resize:"none",disabled:""},model:{value:t.form.content,callback:function(e){t.$set(t.form,"content",e)},expression:"form.content"}})],1),t.checkPermission(["Process"])&&t.form.status<4?s("el-form-item",{staticStyle:{"text-align":"right"}},[t.currentUnit?s("span",{staticStyle:{display:"inline-block","margin-right":"10px"}},[s("el-button",{attrs:{type:"primary"},on:{click:t.handleSign}},[t._v(t._s(t.currentUnit.isSign?"已签收":"签 收"))]),t.checkPermission(["Committee","Allocation"])?s("el-button",{on:{click:function(e){return t.showDialog(3)}}},[t._v("申请退回重新办理")]):t._e()],1):t._e()]):t._e()],1)],1),t.checkPermission(["Allocation"])&&2===t.form.status?s("div",{staticClass:"unit"},[s("el-form",{ref:"department",staticStyle:{height:"100%",position:"relative","padding-bottom":"20px"},attrs:{model:t.department,"label-width":"80px"}},[s("div",[s("el-form-item",{staticClass:"formItem",attrs:{label:"主办单位:"}},[s("el-select",{staticStyle:{width:"260px"},attrs:{placeholder:"请选择"},on:{change:function(e){return t.changeUnit(null)}},model:{value:t.department.first.userId,callback:function(e){t.$set(t.department.first,"userId",e)},expression:"department.first.userId"}},t._l(t.units,(function(e){return s("el-option",{key:e.id,attrs:{label:e.name,value:e.id,disabled:t.checkProcess(e.id)}})})),1)],1)],1),s("div",{staticStyle:{display:"flex"}},[s("div",{staticStyle:{"margin-right":"10px"}},[s("el-form-item",{staticClass:"formItem",attrs:{label:"会办单位:"}},t._l(t.department.seconds,(function(e,a){return s("div",{key:a,staticStyle:{"margin-bottom":"10px"}},[s("el-select",{staticStyle:{width:"260px"},attrs:{placeholder:"请选择"},on:{change:function(e){return t.changeUnit(a)}},model:{value:t.department.seconds[a].userId,callback:function(e){t.$set(t.department.seconds[a],"userId",e)},expression:"department.seconds[index].userId"}},t._l(t.units,(function(e){return s("el-option",{key:e.id,attrs:{label:e.name,value:e.id,disabled:e.id===t.department.first.userId}})})),1),s("i",{staticClass:"el-icon-circle-close",staticStyle:{"margin-left":"5px","font-size":"20px",color:"gray"},on:{click:function(e){return t.delUnit(a)}}})],1)})),0)],1),s("i",{staticClass:"add el-icon-circle-plus-outline",on:{click:function(e){return t.addUnit()}}})])]),s("div",{staticClass:"btn"},[s("el-button",{attrs:{type:"primary"},on:{click:t.saveUnit}},[t._v("保 存")])],1)],1):t._e(),t.form.status>3?s("div",{staticClass:"process"},[s("el-form",{ref:"process",staticStyle:{height:"100%",position:"relative"},attrs:{rules:t.departEules,model:t.processData,"label-width":"100px"}},[null===t.currentUnit||4!==t.form.status&&6!==t.form.status?t._e():s("el-form-item",{staticClass:"formItem",attrs:{prop:4===t.form.status||6===t.form.status?"content":"",label:t.currentUnit.host?"主办单位:":"会办单位:"}},[s("div",{staticClass:"name"},[t._v(t._s(t.currentUnit.name))]),s("el-input",{attrs:{type:"textarea",rows:4,resize:"none",readonly:4!==t.form.status&&6!==t.form.status},model:{value:t.processData.content,callback:function(e){t.$set(t.processData,"content",e)},expression:"processData.content"}})],1),null===t.currentUnit||4!==t.form.status&&6!==t.form.status?t._e():s("el-form-item",{staticClass:"formItem",attrs:{label:"添加附件:"}},[s("el-upload",{ref:"uploadFile",class:!t.checkPermission(["Process"])||null===t.currentUnit||4!==t.form.status&&6!==t.form.status?"previewUpload":"",staticStyle:{width:"30%","min-width":"400px"},attrs:{action:"action",multiple:!0,"http-request":t.uploadFile,"on-preview":t.handlePreview,"on-remove":t.handleRemove,"before-remove":t.beforeRemove,"on-change":t.handleChange,"file-list":t.fileList,disabled:!t.checkPermission(["Process"])||null===t.currentUnit||4!==t.form.status&&6!==t.form.status}},[s("el-button",{attrs:{size:"small",type:"primary",disabled:null===t.currentUnit||4!==t.form.status&&6!==t.form.status}},[t._v("点击上传")])],1)],1),null===t.currentUnit||!t.currentUnit.host||4!==t.form.status&&6!==t.form.status?t._e():s("el-form-item",{staticClass:"formItem",attrs:{label:"办理形式:",prop:null===t.currentUnit||!t.currentUnit.host||4!==t.form.status&&6!==t.form.status?"":"form"}},[s("el-checkbox-group",{model:{value:t.checkList,callback:function(e){t.checkList=e},expression:"checkList"}},[s("el-checkbox",{attrs:{label:"走访面谈"}}),s("el-checkbox",{attrs:{label:"座谈会"}}),s("el-checkbox",{attrs:{label:"调研"}}),s("el-checkbox",{attrs:{label:"视察"}}),s("el-checkbox",{attrs:{label:"电话沟通 "}}),s("el-checkbox",{attrs:{label:"函件"}})],1)],1),null===t.currentUnit||!t.currentUnit.host||4!==t.form.status&&6!==t.form.status?t._e():s("el-form-item",{staticClass:"formItem",attrs:{label:"办理时间:",prop:null===t.currentUnit||!t.currentUnit.host||4!==t.form.status&&6!==t.form.status?"":"time"}},[s("el-date-picker",{attrs:{"value-format":"yyyy-MM-dd HH:mm:ss",type:"datetime",placeholder:"选择时间"},model:{value:t.processData.time,callback:function(e){t.$set(t.processData,"time",e)},expression:"processData.time"}})],1),t.process.length?s("div",{staticStyle:{height:"20px"}}):t._e(),t._l(t.process,(function(e){return s("div",{key:e.userId},[e.firstAnswer&&(!t.checkCode(e.userId)||4!==t.form.status&&6!==t.form.status)?s("el-form-item",{staticClass:"formItem",attrs:{label:e.host?"主办单位:":"会办单位:"}},[s("div",{staticClass:"name"},[t._v(t._s(e.name))]),s("div",[s("div",{staticClass:"name",staticStyle:{"margin-bottom":"0"}},[t._v("一次答复")]),s("el-input",{attrs:{type:"textarea",rows:4,resize:"none",readonly:""},model:{value:e.firstAnswer.content,callback:function(s){t.$set(e.firstAnswer,"content",s)},expression:"item.firstAnswer.content"}}),s("div",[s("div",{staticClass:"name",staticStyle:{"margin-bottom":"0"}},[t._v("添加附件")]),s("el-upload",{staticClass:"previewUpload",staticStyle:{width:"30%","min-width":"400px"},attrs:{action:"action","on-preview":t.handlePreview,"file-list":e.firstAnswer.fileList,disabled:!0}}),e.host?s("div",[s("div",{staticClass:"name",staticStyle:{"margin-bottom":"0"}},[t._v("办理形式")]),s("div",{staticClass:"fontStyle"},[t._v(t._s(e.firstAnswer.form))])]):t._e(),e.host?s("div",[s("div",{staticClass:"name",staticStyle:{"margin-bottom":"0"}},[t._v("办理时间")]),s("div",{staticClass:"fontStyle"},[t._v(t._s(e.firstAnswer.time))])]):t._e()],1)],1),!e.secondAnswer||t.checkCode(e.userId)&&6===t.form.status?t._e():s("div",[s("div",{staticClass:"name",staticStyle:{"margin-bottom":"0"}},[t._v("二次答复")]),s("el-input",{attrs:{type:"textarea",rows:4,resize:"none",readonly:""},model:{value:e.secondAnswer.content,callback:function(s){t.$set(e.secondAnswer,"content",s)},expression:"item.secondAnswer.content"}}),s("div",[s("div",{staticClass:"name",staticStyle:{"margin-bottom":"0"}},[t._v("添加附件")]),s("el-upload",{staticClass:"previewUpload",staticStyle:{width:"30%","min-width":"400px"},attrs:{action:"action","on-preview":t.handlePreview,"file-list":e.secondAnswer.fileList,disabled:!0}}),e.host?s("div",[s("div",{staticClass:"name",staticStyle:{"margin-bottom":"0"}},[t._v("办理形式")]),s("div",{staticClass:"fontStyle"},[t._v(t._s(e.secondAnswer.form))])]):t._e(),e.host?s("div",[s("div",{staticClass:"name",staticStyle:{"margin-bottom":"0"}},[t._v("办理时间")]),s("div",{staticClass:"fontStyle"},[t._v(t._s(e.secondAnswer.time))])]):t._e()],1)],1)]):t._e()],1)})),!t.checkPermission(["Process"])||4!==t.form.status&&6!==t.form.status?t._e():s("el-form-item",{staticClass:"formItem",staticStyle:{"text-align":"right"}},[s("el-button",{attrs:{type:"primary"},on:{click:t.handleSave}},[t._v(t._s(t.currentUnit.host?"保存但不提交最终答复":"提交"))]),t.currentUnit.host?s("el-button",{attrs:{type:"primary"},on:{click:t.handleSubmit}},[t._v("保存并提交最终答复")]):t._e()],1)],2)],1):t._e(),t.form.status>4?s("div",{staticClass:"process"},[s("el-form",{ref:"process",staticStyle:{height:"100%",position:"relative"},attrs:{rules:t.departEules,model:t.processData,"label-width":"100px"}},[s("div",[s("el-form-item",{staticClass:"formItem",attrs:{label:"满意度："}},[s("div",{staticStyle:{opacity:"0.8"}},[t._v(" "+t._s(1===t.form.grade?"满意":2===t.form.grade?"基本满意":3===t.form.grade?"不满意":"未答复")+" ")])]),t.form.gradeReason?s("el-form-item",{staticClass:"formItem",attrs:{label:"评语："}},[s("el-input",{attrs:{type:"textarea",rows:"7",resize:"none",disabled:""},model:{value:t.form.gradeReason,callback:function(e){t.$set(t.form,"gradeReason",e)},expression:"form.gradeReason"}})],1):t._e()],1),t.form.secondGradeReason?s("div",[s("el-form-item",{staticClass:"formItem",attrs:{label:"二次满意度："}},[s("div",{staticStyle:{opacity:"0.8"}},[t._v(" "+t._s(1===t.form.secondGrade?"满意":2===t.form.secondGrade?"基本满意":3===t.form.secondGrade?"不满意":"未答复")+" ")])]),t.form.secondGradeReason?s("el-form-item",{staticClass:"formItem",attrs:{label:"评语："}},[s("el-input",{attrs:{type:"textarea",rows:"7",resize:"none",disabled:""},model:{value:t.form.secondGradeReason,callback:function(e){t.$set(t.form,"secondGradeReason",e)},expression:"form.secondGradeReason"}})],1):t._e()],1):t._e()])],1):t._e(),t.checkPermission(["Committee"])&&8===t.form.status?s("div",{staticClass:"finished"},[s("div",{staticClass:"btns"},[s("el-button",{on:{click:t.handleCancle}},[t._v("取消")]),s("el-button",{attrs:{type:"primary"},on:{click:t.accomplish}},[t._v("办结")]),s("el-button",{attrs:{type:"primary"},on:{click:t.backReAlloc}},[t._v("退回重新分配")])],1)]):t._e(),s("el-dialog",{attrs:{visible:t.failVisible,width:"40%","show-close":!1,"custom-class":"dialogBox"},on:{"update:visible":function(e){t.failVisible=e}}},[s("div",{directives:[{name:"show",rawName:"v-show",value:1===t.type,expression:"type === 1"}],staticClass:"dialog"},[s("div",{staticClass:"title"},[t._v("请填写您的不通过原因")]),s("el-input",{attrs:{type:"textarea",rows:"13",resize:"none"},model:{value:t.auditData.reason,callback:function(e){t.$set(t.auditData,"reason",e)},expression:"auditData.reason"}}),s("div",{staticClass:"btn"},[s("el-button",{on:{click:function(e){t.failVisible=!1}}},[t._v("取 消")]),s("el-button",{attrs:{type:"primary"},on:{click:t.handleAudit}},[t._v("确 定")])],1)],1),s("div",{directives:[{name:"show",rawName:"v-show",value:2===t.type,expression:"type === 2"}],staticClass:"dialog"},[s("div",{staticClass:"title"},[t._v("请输入您的修改内容")]),s("el-input",{attrs:{type:"textarea",rows:"13",resize:"none"},model:{value:t.form.content,callback:function(e){t.$set(t.form,"content",e)},expression:"form.content"}}),s("div",{staticClass:"btn"},[s("el-button",{on:{click:function(e){t.failVisible=!1}}},[t._v("取 消")]),s("el-button",{attrs:{type:"primary"},on:{click:t.handleAudit}},[t._v("确 定")])],1)],1),s("div",{directives:[{name:"show",rawName:"v-show",value:3===t.type,expression:"type === 3"}],staticClass:"dialog"},[s("div",{staticClass:"title"},[t._v("请填写您的申请原因")]),s("el-input",{attrs:{type:"textarea",rows:"13",resize:"none"},model:{value:t.backData.content,callback:function(e){t.$set(t.backData,"content",e)},expression:"backData.content"}}),s("div",{staticClass:"btn"},[s("el-button",{on:{click:function(e){t.failVisible=!1}}},[t._v("取 消")]),s("el-button",{attrs:{type:"primary"},on:{click:t.handleAudit}},[t._v("确 定")])],1)],1),s("div",{directives:[{name:"show",rawName:"v-show",value:4===t.type,expression:"type === 4"}],staticClass:"dialog"},[s("div",{staticClass:"title"},[t._v("请填写不同意的原因")]),s("el-input",{attrs:{type:"textarea",rows:"13",resize:"none"},model:{value:t.disagree.content,callback:function(e){t.$set(t.disagree,"content",e)},expression:"disagree.content"}}),s("div",{staticClass:"btn"},[s("el-button",{on:{click:function(e){t.failVisible=!1}}},[t._v("取 消")]),s("el-button",{attrs:{type:"primary"},on:{click:t.handleWithdraw}},[t._v("确 定")])],1)],1)])],1)])],1)},n=[],r=(s("b64b"),s("e9c4"),s("d3b7"),s("159b"),s("d81d"),s("a15b"),s("a434"),s("7db0"),s("b0c0"),s("c740"),s("3ca3"),s("ddb0"),s("2b3d"),s("9861"),s("99af"),s("e350")),i=s("8039"),o=s("9109"),c=s("5efa"),l={name:"Advice",data:function(){return{clock:!0,expireTimeOption:{disabledDate:function(t){return t.getTime()>Date.now()}},units:[],role:"",params:{kw:"",myTransaction:!0,pageIndex:1,pageSize:20,tag:"",status:Object(r["b"])(["Liaison","rd"])?[0,1,2,3,4,5,6,7,8,9]:[1,2,3,4,5,6,7,8,9]},unitParams:{pageIndex:-1,pageSize:-1,kw:""},suggestList:[],withdraws:[],recordList:[],total:0,show:!1,form:{status:0,tag:sessionStorage.getItem("tag"),metting:"",title:"",first:"",seconds:[],time:"",content:"",category:null},auditData:{pass:!0,reason:""},backData:{content:"",recordId:""},disagree:{id:null,content:"",pass:!0},rules:{metting:[{required:!0,message:"请选择会议期间",trigger:"blur"}],category:[{required:!0,message:"请选择建议类型",trigger:"blur"}],title:[{required:!0,message:"请填写建议标题",trigger:"blur"}],first:[{required:!0,message:"请选择主提议人",trigger:"blur"}],seconds:[{required:!1,message:"请选择附议人择",trigger:"blur"}],time:[{required:!0,message:"请选择建议时间",trigger:"blur"}],content:[{required:!0,message:"请填写建议内容",trigger:"blur"}]},departEules:{content:[{required:!0,message:"答复内容为必填项！",trigger:"blur"}],form:[{required:!0,message:"办理形式为必填项！",trigger:"blur"}],time:[{required:!0,message:"办理时间为必填项！",trigger:"blur"}]},isLiaison:!1,failVisible:!1,recordVisible:!1,type:1,unitIndex:null,currentUnit:null,process:[],department:{id:"",first:{name:"",userId:""},seconds:[]},options:[],commandTag:"全 部",tags:[{value:[0],label:"未提交"},{value:[1],label:"待审核"},{value:[2],label:"待分配"},{value:[3],label:"待签收"},{value:[4],label:"第一次处理中"},{value:[5],label:"第一次已答复"},{value:[6],label:"第二次处理中"},{value:[7],label:"第二次已答复"},{value:[8],label:"待办结处理"},{value:[9],label:"已办结"}],current:1,dialogImageUrl:"",imgVisible:!1,fileList:[],processData:{content:"",attachments:[],form:null,time:null},checkList:[],completeData:{pass:!0,reason:""},answers:[],staffList:[],cascaderStaffList:[],lock:!0,committeeEditStatus:!1,firstCascaderValue:[],secondCascaderValue:[]}},computed:{canEditForm:function(){return 0===this.form.status||"committee"===sessionStorage.getItem("responseRoleCode")&&1===this.form.status&&this.committeeEditStatus},hasExportRight:function(){var t=sessionStorage.getItem("responseRoleCode");return"committee"===t||"administrator"===t},secondsCascader:function(){var t=this;if(0===this.firstCascaderValue.length)return this.cascaderStaffList;var e=JSON.parse(JSON.stringify(this.cascaderStaffList));return e.forEach((function(e){e.children.map((function(e){e.value===t.firstCascaderValue[1]&&(e.disabled=!0)}))})),e}},watch:{show:function(t,e){e&&(this.form={status:0,tag:"",metting:"",title:"",first:"",seconds:[],time:"",content:""},this.processData={content:"",attachments:[],form:null,time:null},this.fileList=[],this.currentUnit=null,this.disagree={id:null,content:"",pass:!0},console.log(88888,this.disagree),console.log(this.$route.query),this.$route.query.id&&(this.$router.push({query:{}}),window.history.replaceState("","",this.$route.fullPath.split("?")[0])),console.log(this.$route.query))},checkList:function(t){this.processData.form=t.join(",")},failVisible:function(t){t?1===this.type&&(this.auditData.pass=!1):(this.auditData.pass=!0,this.auditData.reason="")},form:{handler:function(t){var e=this;if(console.log(t),t.firstUnit){var s=[];t.firstUnit.host=!0,Object(r["a"])(t.firstUnit.userId)?(this.currentUnit=t.firstUnit,s.push(t.firstUnit),t.secondUnit.forEach((function(t){t.host=!1,s.push(t)})),this.process=s):(s.push(t.firstUnit),t.secondUnit.forEach((function(t){t.host=!1,s.push(t),Object(r["a"])(t.userId)&&(e.currentUnit=t)})),this.process=s),console.log(this.process),this.currentUnit&&this.currentUnit.host&&this.currentUnit.form?this.checkList=this.currentUnit.firstAnswer.form.split(","):this.checkList=[],this.currentUnit&&this.currentUnit.secondAnswer&&this.form.status>3?(this.processData.content=this.currentUnit.secondAnswer.content,this.processData.time=t.firstUnit.secondAnswer.time,this.processData.form=t.firstUnit.secondAnswer.form,this.checkList=t.firstUnit.secondAnswer.form.split(","),this.processData.attachments=JSON.parse(this.currentUnit.secondAnswer.attachments),this.processData.attachments.forEach((function(t){var s={name:t.split("Attachments/")[t.split("Attachments/").length-1],url:t,status:"success"};e.fileList.push(s)}))):this.currentUnit&&this.currentUnit.firstAnswer&&this.form.status>3&&(this.processData.content=this.currentUnit.firstAnswer.content,this.processData.time=t.firstUnit.firstAnswer.time,this.processData.form=t.firstUnit.firstAnswer.form,this.checkList=t.firstUnit.firstAnswer.form.split(","),this.processData.attachments=JSON.parse(this.currentUnit.firstAnswer.attachments),this.processData.attachments.forEach((function(t){var s={name:t.split("Attachments/")[t.split("Attachments/").length-1],url:t,status:"success"};e.fileList.push(s)})))}},immediate:!1,deep:!0},firstCascaderValue:{handler:function(t,e){var s=this;t[1];this.form.first=t[1],this.secondCascaderValue.forEach((function(e,a){var n=e.lastIndexOf(t[1]);n>=0&&s.secondCascaderValue.splice(a,1)}))}},secondCascaderValue:{handler:function(t,e){var s=[];t.forEach((function(t){s.push(t[1])})),this.form.seconds=s}}},created:function(){var t=this;this.getStaff(),this.getUnits(),this.$route.query.id&&(console.log(this.$route.query.id),this.checkDetail({id:this.$route.query.id})),sessionStorage.setItem("tag",""),Object(c["d"])({}).then((function(e){var s=[{value:0,lable:"全 部"}];e.forEach((function(t){s.push({value:t.id,lable:t.title})}));var a=e.find((function(t){return!t.isEnable}));sessionStorage.setItem("tag",a.title),t.commandTag=sessionStorage.getItem("tag"),t.params.tag=t.commandTag,t.options=s,t.getList()}))},mounted:function(){this.$nextTick((function(){var t=document.getElementsByClassName("el-pagination");t&&(document.getElementsByClassName("btn-prev")[0].innerHTML="上一页",document.getElementsByClassName("btn-next")[0].innerHTML="下一页")}))},methods:{checkPermission:r["b"],checkCode:r["a"],handleCommand:function(t){console.log(t),this.commandTag=t,this.params.tag="全 部"===t?"":t,this.getList()},getUnits:function(){var t=this;Object(o["e"])(this.unitParams).then((function(e){e.success?t.units=e.data.list:t.$message.error(e.msg)}))},getStaff:function(){var t=this;Object(i["E"])().then((function(e){e.success?(e.data.forEach((function(t){t.id=JSON.parse(t.id)})),t.staffList=e.data):t.$message.error("获取人员列表失败！")})),Object(i["i"])().then((function(e){e.success?t.cascaderStaffList=e.data:t.$message.error("获取人员列表失败！")}))},check:function(t){this.params.status=t.value,this.getList()},indexMethod:function(t){return t+(this.params.pageIndex-1)*this.params.pageSize+1},handleSizeChange:function(t){this.params.pageSize=t,this.getList()},handleCurrentChange:function(t){this.params.pageIndex=t,this.getList()},getList:function(){var t=this;Object(i["F"])(this.params).then((function(e){e.success?(Object(i["E"])().then((function(e){e.success?(e.data.forEach((function(t){t.id=JSON.parse(t.id)})),t.staffList=e.data):t.$message.error("获取人员列表失败！")})),t.total=e.data.totalPageNumber,e.data.list.forEach((function(e){t.staffList.forEach((function(t){JSON.stringify(t.id)===e.first&&(e.proposer=t.name)})),3===e.status&&e.firstUnit.userId&&(Object(r["a"])(e.firstUnit.userId)?e.isSign=e.firstUnit.isSign:e.secondUnit.forEach((function(t){t.userId&&Object(r["a"])(t.userId)&&(e.isSign=t.isSign)})))})),t.suggestList=e.data.list,t.suggestList.totalCount=e.data.totalCount):t.$message.error(e.msg)}))},checkDetail:function(t){var e=this;this.backData.recordId=t.id,Object(i["c"])(t.id).then((function(t){if(t.success){var s=t.data.suggest.status;if((3===s||4===s||6===s)&&t.data.withdraws.length)for(var a=0;a<t.data.withdraws.length;a++){var n=t.data.withdraws[a];if(0===n.status){e.disagree.id=n.id;break}console.log(n)}2===t.data.suggest.status&&(e.department.id=t.data.suggest.id),t.data.suggest.status>2&&(t.data.answers.forEach((function(e){e.fileList=[],e.attachments&&JSON.parse(e.attachments).forEach((function(t){var s={name:t.split("Attachments/")[t.split("Attachments/").length-1],url:t,status:"success"};e.fileList.push(s)})),e.userId===t.data.suggest.firstUnit.userId?0===e.type?t.data.suggest.firstUnit.firstAnswer=e:t.data.suggest.firstUnit.secondAnswer=e:t.data.suggest.secondUnit.forEach((function(t){t.userId===e.userId&&(0===e.type?t.firstAnswer=e:t.secondAnswer=e)}))})),t.data.withdraws.forEach((function(e){e.userId===t.data.suggest.firstUnit.userId?e.name=t.data.suggest.firstUnit.name:t.data.suggest.secondUnit.forEach((function(t){e.userId===t.userId&&(e.name=t.name)}))}))),e.answers=t.data.answers,e.form=t.data.suggest,e.withdraws=t.data.withdraws;var r=[];e.cascaderStaffList.forEach((function(t){t.children.forEach((function(s){s.value===e.form.first&&(e.firstCascaderValue=[t.value,s.value]),e.form.seconds.lastIndexOf(s.value)>=0&&(r.push([t.value,s.value]),console.info(r))}))})),e.secondCascaderValue=r,e.show=!0}else e.$message.error(t.msg)}))},handleCancle:function(){Object(r["b"])(["Liaison","rd"])&&0===this.form.status&&this.$refs.form.resetFields(),Object(r["b"])(["Allocation"])&&2===this.form.status&&(this.department={id:"",first:{name:"",userId:""},seconds:[]}),Object(r["b"])(["Process"])&&this.form.status>3&&this.$refs.process.resetFields(),this.failVisible=!1,this.auditData.reason="",this.show=!1,this.$refs.uploadFile&&this.$refs.uploadFile.clearFiles(),this.getList()},checkProposer:function(t){var e=this.form.seconds.find((function(e){return e===t}));return!!e},save:function(){var t=this;this.form.tag=sessionStorage.getItem("tag"),this.clock&&(this.clock=!1,this.$refs.form.validate((function(e){e?Object(i["b"])(t.form).then((function(e){try{e.success?1===t.form.status?Object(i["h"])(t.form.id,t.auditData).then((function(e){e.success?(t.$message.success("修改成功"),t.handleCancle()):t.$message.error(e.msg)})):(t.$message.success("保存成功！"),t.handleCancle()):1===t.form.status?t.$message.error("修改失败！"):t.$message.error("保存失败！")}finally{t.clock=!0}})).catch((function(e){t.clock=!0,console.log(e)})):(t.$message.error("请完善表格内容"),t.clock=!0)})))},submit:function(){var t=this;this.clock&&(this.clock=!1,this.$refs.form.validate((function(e){e?(t.form.tag=sessionStorage.getItem("tag"),Object(i["b"])(t.form).then((function(e){e.success?Object(i["g"])(e.msg).then((function(e){try{e.success?(t.$message.success("提交成功"),t.handleCancle()):t.$message.error(e.msg)}finally{t.clock=!0}})).catch((function(e){t.clock=!0,console.log(e)})):(t.$message.error(e.msg),t.clock=!0)}))):(t.$message.error("请完善表格内容"),t.clock=!0)})))},showDialog:function(t){this.type=t,this.failVisible=!0},handleAudit:function(){var t=this;this.failVisible?1===this.type?this.auditData.reason?Object(i["h"])(this.form.id,this.auditData).then((function(e){e.success?(t.$message.success("提交成功"),t.handleCancle()):t.$message.error(e.msg)})):this.$message.error("请填写不通过的原因"):2===this.type?this.form.content?this.save():this.$message.error("请输入修改的内容"):3===this.type?this.backData.content?Object(i["f"])(this.backData).then((function(e){e.success?(t.$message.success("申请成功！"),t.handleCancle()):t.$message.error(e.msg)})):this.$message.error("请填写您的申请原因"):4===this.type&&(this.disagree?Object(i["m"])().then((function(e){e.success?(t.$message.success("操作成功！"),t.handleCancle()):t.$message.error(e.msg)})):this.$message.error("请填写不同意的原因")):this.$confirm("确定通过吗?","提示",{confirmButtonText:"确定",cancelButtonText:"取消",type:"warning"}).then((function(){Object(i["h"])(t.form.id,t.auditData).then((function(e){e.success?(t.$message.success("审核已通过！"),t.handleCancle()):t.$message.error(e.msg)}))}))},changeUnit:function(t){var e=this;if(t||0===t){var s=this.units.find((function(s){return s.id===e.department.seconds[t].userId}));s&&(this.department.seconds[t].name=s.name)}else{var a=this.units.find((function(t){return t.id===e.department.first.userId}));a&&(this.department.first.name=a.name)}},checkProcess:function(t){console.log(t);var e=this.department.seconds.find((function(e){return e.userId===t}));return!!e},addUnit:function(){var t={name:"",userId:""};this.department.seconds.push(t)},delUnit:function(t){this.department.seconds.splice(t,1)},committeeUpdateSuggest:function(){this.type=2,this.committeeEditStatus&&this.save(),this.committeeEditStatus=!this.committeeEditStatus},saveUnit:function(){var t=this;if(this.lock)if(this.lock=!1,this.department.first.userId){var e=this.department.seconds.findIndex((function(t){return""===t.userId}));-1===e?Object(i["d"])(this.department).then((function(e){e.success?(t.$message.success("分配成功！"),t.handleCancle()):t.$message.error(e.msg),t.lock=!0})).catch((function(e){t.lock=!0})):(this.$message.error("请选择会办部门"),this.lock=!0)}else this.$message.error("请选择主办部门"),this.lock=!0},handleSign:function(){var t=this;this.$confirm("确定签收吗?","提示",{confirmButtonText:"确定",cancelButtonText:"取消",type:"warning"}).then((function(){t.lock&&(t.lock=!1,t.currentUnit&&t.currentUnit.isSign?(t.$message.info("已签收，等待其他办理部门签收"),t.lock=!0):Object(i["D"])(t.form.id).then((function(e){t.lock=!0,e.success?(t.$message.success("已签收"),t.checkDetail(t.form)):t.$message.error(e.msg)})).catch((function(e){t.lock=!0})))}))},checkRecord:function(t){var e=this;Object(i["B"])().then((function(t){t.success?(e.recordList=t.data,e.recordVisible=!0):e.$message.error(t.msg)}))},handleSave:function(){var t=this;this.$refs.process.validate((function(e){e?t.$confirm("确定".concat(t.currentUnit.host?"保存但不提交最终答复":"提交","吗?"),"提示",{confirmButtonText:"确定",cancelButtonText:"取消",type:"warning"}).then((function(){t.lock&&(t.lock=!1,Object(i["e"])(t.form.id,t.processData).then((function(e){e.success?(t.$message.success("保存成功！"),t.handleCancle()):t.$message.error(e.msg),t.lock=!0})).catch((function(e){t.lock=!0})))})):t.$message.error("请完善表格内容")}))},handleSubmit:function(){var t=this;this.$refs.process.validate((function(e){e?t.$confirm("确定保存并提交最终答复吗?","提示",{confirmButtonText:"确定",cancelButtonText:"取消",type:"warning"}).then((function(){t.lock&&(t.lock=!1,Object(i["e"])(t.form.id,t.processData).then((function(e){try{e.success?Object(i["j"])(t.form.id,t.completeData).then((function(e){e.success?e.data?(t.$message.success("提交成功！"),t.handleCancle()):t.$message.error("仍有会办部门未提交！"):t.$message.error(e.msg)})):t.$message.error(e.msg)}finally{t.lock=!0}})).catch((function(e){t.lock=!0})))})):t.$message.error("请完善内容")}))},uploadFile:function(t){var e=this,s=new FormData;s.append("file",t.file),Object(i["G"])(s).then((function(t){if(t.success){e.$message.success("上传成功"),e.processData.attachments.push(t.msg);var s={name:t.msg.split("Attachments/")[t.msg.split("Attachments/").length-1],url:t.msg,status:"success"};e.fileList.push(s)}else e.$message.error(t.msg)})).catch((function(t){console.log(t)}))},beforeRemove:function(t,e){if("success"===t.status)return this.$confirm("确认删除".concat(t.name,"吗"),"确认删除")},handleRemove:function(t,e){for(var s=0;s<this.processData.attachments.length;s++)t.url===this.processData.attachments[s]&&(this.processData.attachments.splice(s,1),this.fileList.splice(s,1))},handlePreview:function(t){console.log(t);var e=document.createElement("a");e.style.display="none",e.target="_blank",e.href="/api".split("api")[0]+t.url,document.body.appendChild(e),e.click(),document.body.removeChild(e)},handleChange:function(t,e){console.log(t,e,this.fileList)},handleWithdraw:function(){var t=this;this.failVisible?(this.disagree.pass=!1,this.disagree.content?Object(i["H"])(this.disagree).then((function(e){e.success?(t.$message.success("已驳回！"),t.handleCancle()):t.$message.error("已驳回，请勿重复操作")})):this.$message.error("请填写不同意的原因")):(this.disagree.pass=!0,this.$confirm("确定退回吗?","提示",{confirmButtonText:"确定",cancelButtonText:"取消",type:"warning"}).then((function(){Object(i["H"])(t.disagree).then((function(e){e.success?(t.$message.success("已撤回！"),t.handleCancle()):t.$message.error("撤回失败！")}))})))},accomplish:function(){var t=this;this.$confirm("确定办结吗?","提示",{confirmButtonText:"确定",cancelButtonText:"取消",type:"warning"}).then((function(){Object(i["a"])(t.form.id).then((function(e){e.success?(t.$message.success("已办结！"),t.handleCancle()):t.$message.error(e.msg)}))})).catch((function(){}))},backReAlloc:function(){var t=this;this.$confirm("是否退回重新分配","提示").then((function(e){return Object(i["z"])(t.backData.recordId)})).then((function(e){t.$message("操作成功！"),t.checkDetail({id:t.backData.recordId}),t.getList()})).catch((function(t){"cancel"===t&&console.info("被取消")}))},btnExport:function(){Object(i["y"])(this.params).then((function(t){var e=new Date,s=window.URL.createObjectURL(new Blob([t],{type:"application/vnd.openxmlformats-officedocument.spreadsheetml.sheet"})),a=document.createElement("a");a.style.display="none",a.href=s,a.setAttribute("download","建议批量导出 ".concat(e.getFullYear(),"年").concat(e.getMonth()+1,"月").concat(e.getDay(),"号 ").concat(e.getHours(),"时").concat(e.getMinutes(),"分.xlsx")),document.body.appendChild(a),a.click(),document.body.removeChild(a)}))},btnDownload:function(t){Object(i["q"])(t.id).then((function(e){var s=new Date,a=window.URL.createObjectURL(new Blob([e],{type:"application/vnd.openxmlformats-officedocument.wordprocessingml.document"})),n=document.createElement("a");n.style.display="none",n.href=a,n.setAttribute("download","【建议】".concat(t.code," ").concat(s.getFullYear(),"年").concat(s.getMonth()+1,"月").concat(s.getDay(),"号 ").concat(s.getHours(),"时").concat(s.getMinutes(),"分.docx")),document.body.appendChild(n),n.click(),document.body.removeChild(n)}))}}},u=l,d=(s("f6d2"),s("4109"),s("2877")),m=Object(d["a"])(u,a,n,!1,null,"31809bac",null);e["default"]=m.exports},"7db0":function(t,e,s){"use strict";var a=s("23e7"),n=s("b727").find,r=s("44d2"),i=s("ae40"),o="find",c=!0,l=i(o);o in[]&&Array(1)[o]((function(){c=!1})),a({target:"Array",proto:!0,forced:c||!l},{find:function(t){return n(this,t,arguments.length>1?arguments[1]:void 0)}}),r(o)},8039:function(t,e,s){"use strict";s.d(e,"p",(function(){return n})),s.d(e,"G",(function(){return r})),s.d(e,"F",(function(){return i})),s.d(e,"B",(function(){return o})),s.d(e,"c",(function(){return c})),s.d(e,"b",(function(){return l})),s.d(e,"h",(function(){return u})),s.d(e,"g",(function(){return d})),s.d(e,"d",(function(){return m})),s.d(e,"D",(function(){return f})),s.d(e,"e",(function(){return h})),s.d(e,"j",(function(){return p})),s.d(e,"f",(function(){return g})),s.d(e,"m",(function(){return b})),s.d(e,"H",(function(){return v})),s.d(e,"a",(function(){return y})),s.d(e,"E",(function(){return w})),s.d(e,"i",(function(){return k})),s.d(e,"k",(function(){return C})),s.d(e,"z",(function(){return _})),s.d(e,"y",(function(){return x})),s.d(e,"q",(function(){return S})),s.d(e,"n",(function(){return $})),s.d(e,"o",(function(){return O})),s.d(e,"C",(function(){return U})),s.d(e,"l",(function(){return j})),s.d(e,"A",(function(){return I})),s.d(e,"r",(function(){return D})),s.d(e,"x",(function(){return L})),s.d(e,"w",(function(){return E})),s.d(e,"v",(function(){return A})),s.d(e,"t",(function(){return T})),s.d(e,"s",(function(){return P})),s.d(e,"u",(function(){return V}));s("99af");var a=s("b775");function n(t){return Object(a["a"])({url:"/suggest/downloadSubContentAll",method:"get",params:{tag:t},responseType:"arraybuffer"})}function r(t){return Object(a["a"])({url:"/suggest/attachment",method:"post",data:t})}function i(t){return Object(a["a"])({url:"/suggest/list",method:"post",data:t})}function o(t){return Object(a["a"])({url:"/record/list",method:"post",data:t})}function c(t){return Object(a["a"])({url:"/suggest/".concat(t),method:"get"})}function l(t){return Object(a["a"])({url:"/suggest",method:"post",data:t})}function u(t,e){return Object(a["a"])({url:"/suggest/check/".concat(t),method:"put",data:e})}function d(t){return Object(a["a"])({url:"/suggest/submitCheck/".concat(t),method:"put"})}function m(t){return Object(a["a"])({url:"/suggest/allocation",method:"post",data:t})}function f(t){return Object(a["a"])({url:"/suggest/sign/".concat(t),method:"put"})}function h(t,e){return Object(a["a"])({url:"/suggest/answer/".concat(t),method:"put",data:e})}function p(t,e){return Object(a["a"])({url:"/suggest/completeAnswer/".concat(t),method:"put",data:e})}function g(t){return Object(a["a"])({url:"/SuggestWithdraw",method:"post",data:t})}function b(t,e){return Object(a["a"])({url:"/suggest/disagree/".concat(t),method:"post",data:e})}function v(t){return Object(a["a"])({url:"/SuggestWithdraw/check",method:"post",data:t})}function y(t,e){return Object(a["a"])({url:"/suggest/accomplish/".concat(t,"?completedResultStatus=").concat(e),method:"put"})}function w(){return Object(a["a"])({url:"/member",method:"get"})}function k(){return Object(a["a"])({url:"/member/cascader",method:"get"})}function C(t){return Object(a["a"])({url:"/boards?tag=".concat(t),method:"get"})}function _(t){return Object(a["a"])({url:"/suggest/reAlloc?id=".concat(t),method:"post"})}function x(t){return Object(a["a"])({url:"/suggest/export",method:"POST",responseType:"arraybuffer",data:t})}function S(t){return Object(a["a"])({url:"/suggest/download",method:"get",responseType:"arraybuffer",params:{id:t}})}function $(t){return Object(a["a"])({url:"/suggest/downloadManYiDu",method:"get",responseType:"arraybuffer",params:{id:t}})}function O(t){return Object(a["a"])({url:"/suggest/downloadSubContent",method:"get",responseType:"arraybuffer",params:{id:t}})}function U(t){return Object(a["a"])({url:"/suggest/gradeAnswer",method:"post",responseType:"arraybuffer",data:t})}function j(t){return Object(a["a"])({url:"/suggest/".concat(t),method:"DELETE"})}function I(t){return Object(a["a"])({url:"/suggest/reOrdering",method:"PUT",params:{tag:t}})}function D(t,e,s){return Object(a["a"])({url:"/suggest/exportAllSuggestsExcel",method:"get",responseType:"arraybuffer",params:{begin:t,end:e,tag:s}})}function L(t,e,s){return Object(a["a"])({url:"/suggest/exportManYiDuSuggestsExcel",method:"get",responseType:"arraybuffer",params:{begin:t,end:e,tag:s}})}function E(t,e,s){return Object(a["a"])({url:"/suggest/exportFirstUnitSuggestsExcel",method:"get",responseType:"arraybuffer",params:{begin:t,end:e,tag:s}})}function A(t,e,s){return Object(a["a"])({url:"/suggest/exportFirstUnitDetailSuggests",method:"get",responseType:"arraybuffer",params:{begin:t,end:e,tag:s}})}function T(t,e,s){return Object(a["a"])({url:"/suggest/exportCategorySuggestsExcel",method:"get",responseType:"arraybuffer",params:{begin:t,end:e,tag:s}})}function P(t,e,s){return Object(a["a"])({url:"/suggest/exportCategoryDetailSuggestsExcel",method:"get",responseType:"arraybuffer",params:{begin:t,end:e,tag:s}})}function V(t,e,s){return Object(a["a"])({url:"/suggest/exportCompletedTypeSuggestsExcel",method:"get",responseType:"arraybuffer",params:{begin:t,end:e,tag:s}})}},9109:function(t,e,s){"use strict";s.d(e,"e",(function(){return n})),s.d(e,"a",(function(){return r})),s.d(e,"d",(function(){return i})),s.d(e,"b",(function(){return o})),s.d(e,"c",(function(){return c}));var a=s("b775");function n(t){return Object(a["a"])({url:"/user",method:"get",params:t})}function r(t){return Object(a["a"])({url:"user",method:"post",data:t})}function i(t){return Object(a["a"])({url:"/user/".concat(t),method:"get"})}function o(t){return Object(a["a"])({url:"admin",method:"get",params:t})}function c(t){return Object(a["a"])({url:"/user/".concat(t),method:"delete"})}},aaaf:function(t,e,s){},e350:function(t,e,s){"use strict";s.d(e,"b",(function(){return n})),s.d(e,"a",(function(){return r}));s("d3b7"),s("caad"),s("2532");var a=s("4360");function n(t){if(t&&t instanceof Array&&t.length>0){var e=a["a"].getters&&a["a"].getters.roles,s=t,n=e.some((function(t){return s.includes(t)}));return n}return console.error("need roles! Like v-permission=\"['admin','editor']\""),!1}function r(t){if(t){var e=a["a"].getters&&a["a"].getters.code;return t===e}return console.error("部门编号为空"),!1}},f6d2:function(t,e,s){"use strict";s("2e25")}}]);